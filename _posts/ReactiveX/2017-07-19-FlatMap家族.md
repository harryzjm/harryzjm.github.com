---  
layout: post  
title: FlatMapå®¶æ—  
category: ReactiveX  
tags: Swift Define  
keywords: Jekyll,Github  
description: 
---  

## ä»£ç   
```swift  
struct Player {  
  var score: BehaviorSubject<CustomStringConvertible>  
}  

let ğŸ‘¦ğŸ» = Player(score: BehaviorSubject(value: 0))  
let ğŸ‘§ğŸ¼ = Player(score: BehaviorSubject(value: "A"))  

let player = Variable(ğŸ‘¦ğŸ»)  

player.asObservable()  
  .flatMap {  $0.score.asObservable() }  
  .subscribe(onNext: { print($0, terminator: "\t") })  
  .disposed(by: bag)  

ğŸ‘¦ğŸ».score.onNext(1)  

player.value = ğŸ‘§ğŸ¼  

ğŸ‘§ğŸ¼.score.onNext("B")  
ğŸ‘¦ğŸ».score.onNext(2)  

//flatMapFirst æ—¶æ‰“å¼€  
//print("\nCompleted")  
//ğŸ‘¦ğŸ».score.onCompleted()  
//player.value = ğŸ‘§ğŸ¼  
//ğŸ‘§ğŸ¼.score.onNext("C")  
```  

ä¸‹é¢å„æ–¹æ³•æ›¿æ¢åçš„è¾“å‡º  
## flatMap  
```swift  
0	1	A	B	2  
```  
æ”¹å˜Valueå³å¢åŠ ä¸€ä¸ªæµ, æ‰€æœ‰ä¿¡å·å‡æ”¶  
## flatMapLatest  
```swift  
0	1	A	B  
```  
æ”¹å˜Valueå³åˆ‡æ¢æµ, æ¥æ”¶æ–°æµ  
æ³¨: ä¸**switchLatest**åŒºåˆ«  
.flatMapLatest(func) == .map(func).switchLatest()  
## flatMapFirst  
```swift  
0	1	2  
Completed  
B	C  
```  
æ”¹å˜Value, å»æ£€æŸ¥ä¹‹å‰æµæœ‰æ— ç»“æŸ, ç»“æŸå³å¼€å§‹æ–°æµ, æœªç»“æŸ, ç»§ç»­ä¹‹å‰çš„æµ  

![](/assets/postAssets/2017/15005182581412.webp)  
![](/assets/postAssets/2017/15005183699092.webp)  

![](/assets/postAssets/2017/15005434002477.webp)  

